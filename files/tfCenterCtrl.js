angular.controllers.controller("tfCenterCtrl",["$timeout","$rootScope","$scope","user","$state","prompt","routeHistory","requestTF","localStorage","appState","request","data","$camera","$ocLazyLoad","lokiService",function(e,t,o,n,i,s,a,r,c,u,l,d,p,g,m){function f(){o.currentStatus.joinStat.mathClearance?i.go("main.xuetang",{type:1}):i.go("main.buyIntroduce",{type:1})}o.user=n.user,o.userType=n.userType,o.isIos=window.cordova&&ionic.Platform.isIOS(),o.recordData={recordDetail:{}},o.getScan=function(){function e(e){r.jsonp("scan/parentScanQrcode",{_host:appConf.XT_HOST,code:encodeURI(e)},(function(e){if(27==e.data.rtype){var t=e.data.course||[];t.current?$openResource({url:t.current.url,title:t.current.title,itype:"video",scope:o,animation:"slide-in-right"}):$openResource({url:t.list[0].weike[0].url,title:t.list[0].weike[0].title,itype:"video",scope:o,animation:"slide-in-right"})}else if(26==e.data.rtype)$openResource({url:e.data.weike.url,title:e.data.weike.title,itype:"video",scope:o,animation:"slide-in-right"});else if(47==e.data.rtype)$openResource({url:e.data.courseCatalog.review.url,title:e.data.courseCatalog.review.name,itype:"video",scope:o,animation:"slide-in-right"});else{if(ionic.Platform.isIOS())return void s.alert('<div class="center">抱歉，苹果端暂不支持扫码答题，功能在紧急开发中</div>',(function(){}),"知道了");!function(e){var t,o=e.data.diagnosis.hasRecord,i=e.data.diagnosis.examID;o.answerExamID&&1==o.status?1==o.needToSelf?(t={ssk:n.user.childS.ssk,aeid:o.answerExamID,view:"answer"},u.goTifen("main.stuTestSelf",t)):(t={ssk:n.user.childS.ssk,answerExamID:o.answerExamID,type:"parent"},u.goTifen("main.scanReport",t)):(t={ssk:n.user.childS.ssk,examID:i,sceneID:135,type:"parent"},u.goTifen("main.do",t))}(e)}}),(function(t){72==t.status?l.jsonp("user/BingScan",{_host:appConf.host_xt+"r=parents/",code:e},(function(t){d.qrCode=t.data,i.go("main.qrCodeRelate",{code:e}),s.loading.hide()}),(function(e){s.showTip(e.msg),s.loading.hide()})):66==t.status?(s.loading.hide(),s.confirm("<span>您还未购买课程，无法扫描查看辅材课程资源，购买课程学习所有课程</span>",(function(e){3==o.user.childS.schoolTypeID?i.go("main.buyIntroduce",{type:0}):i.go("main.buyIntroduce",{type:1})}),"购买课程","知道了",(function(e){}),!1,!1),$(".popup").css({width:"270px !important"}),$(".popup-title").css({"line-height":"25px"})):(s.loading.hide(),s.showTip(t.msg))}))}console.log("00998877"),window.cordova?p.scan((function(t){if(0==t.status){var o=t.text;console.log(t,"二维码"),"string"==typeof o?e(o):s.showTip("扫描二维码无效")}}),(function(e){s.showTip(e.msg)})):g.load("https://res.wx.qq.com/open/js/jweixin-1.6.0.js").then((function(){r.jsonp("wechat/GetJsSign",{authUrl:location.href.split("#")[0],_host:appConf.domain_xt+"/index.php?r=parents/"},(function(t){if(t.data){console.log(t);var o=t.data||{},n=o.appId,i=o.nonceStr,s=o.signature,a=o.timestamp;console.log("appId:"+n,"nonceStr:"+i,"signature:"+s,"timestamp:"+a),wx.config({debug:!1,appId:n,timestamp:a,nonceStr:i,signature:s,jsApiList:["scanQRCode"]}),wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(t){var o=t.resultStr;console.log(o),o&&e(o)}})}}),(function(e){s.showTip(e.msg)}))}))},o.toDis=function(){i.go("main.buyIntroduce",{type:1})},o.go365=function(){i.go("main.buyIntroduce365")},o.toCenter=function(){o.changeTypeTab(1)},n.user.childS&&(r.jsonp("user/recommendCourses",{_host:appConf.T_HOST,ssk:n.user.childS.ssk},(function(e){o.items_list.list=e.data.list||[]}),(function(e){s.showTip(e.msg)})),r.jsonp("user/getUserCourseStat",{ssk:n.user.childS.ssk},(function(e){o.currentStatus.joinStat=e.data.joinStat,o.currentStatus.buyStat=e.data.buyStat}),(function(e){o.dataError=!0})),r.jsonp("user/getServiceStatus",{serviceID:35},(function(e){0==e.status&&(o.currentStatus.mingshi=e.data)}),(function(e){s.showTip(e.msg)})),r.jsonp("user/getTestRecordTotal",{ssk:n.user.childS.ssk},(function(e){e.data&&(m.userKeyValue.recordDetail={evaluationDoneTotal:e.data.evaluationDoneTotal||0,reviewDoneTotal:e.data.reviewDoneTotal||0,reviewTotal:e.data.reviewTotal||0},o.recordData.recordDetail=m.userKeyValue.recordDetail)}),(function(e){s.showTip(e.msg)}))),o.getXTModel=function(e,t){n.user.info.childIndex;if(n.user.childS)switch(e){case 101:break;case 104:f();break;case 105:i.go("main.examination",{type:e,title:t});break;case 102:i.go("main.exerType",{title:t});break;case 103:i.go("main.mockExam",{title:t})}else s.showTip("请添加孩子")},o.toXXKJModel=function(e,t){n.user.info.childIndex;var o=n.user.childS,i={ssk:n.user.childS.ssk,hostSsk:n.user.ssk};if(o)switch(e){case"incorrectExer":u.goXwkongjian("main.incorrectExer",i);break;case"exerRecord":u.goXwkongjian("main.exerRecord",i);break;case"evaluation":u.goXwkongjian("main.evaluation",i);break;case"studentReport":i.answerExamID=t.aeid,i.examID=t.examID,i.title="测评记录报告",139==t.sceneID&&(i.sync="true"),u.goXwkongjian("main.studentReport",i);break;case"course":u.goXwkongjian("main.userRank",i);break;case"courseIndex":u.goXwkongjian("main.courseIndex",i);break;case"checkPoint":u.goXwkongjian("main.checkPoint",i)}else s.showTip("请添加孩子")},o.toTBKC=function(e){if(e)i.go("main.buyIntroduce",{type:2});else if(o.currentStatus.joinStat.syncCourse){var t={ssk:n.user.childS.ssk,hostSsk:n.user.ssk};u.goXwkongjian("main.courseIndex",t)}else i.go("main.buyIntroduce",{type:2})},o.goTbj=function(){u.goTbj("tab.main",{ssk:n.user.childS.ssk})},o.goTifen=function(e){u.goTifen(e,{ssk:n.user.childS.ssk})},o.items={1:[{goTo:f,title:"小学数学提分学习",img:"img/tf-center/sxtg.png",subtitle:"数学通关.赢",note:"考点查补+考点强化，有效提分"}],2:[{goTo:f,title:"中考数学冲刺学习",img:"img/tf-center/sxtg.png",subtitle:"数学通关.赢",note:"10个专题，454节名师微课，个性化查漏补缺精准辅导"}],3:[{goTo:f,title:"高考冲刺学习",img:"img/tf-center/sxtg.png",subtitle:"数学通关.赢",note:"高考数学个性化查漏补缺辅导， 系统有效的提分体系"},{goTo:function(){1!=o.currentStatus.joinStat.scoreCourse&&1!=o.currentStatus.buyStat.scoreCourse?n.user.childS.areaID?i.go("main.buyIntroduce",{type:0}):i.go("main.perfectChildStep1"):o.goTifen("main.home")},title:"高考数学名师提分",img:"img/tf-center/tfkc.png",subtitle:"高考数学名师提分课程",note:"平均17年一线名校教学经验的老师亲自传授高考提分之法"}]}}]);